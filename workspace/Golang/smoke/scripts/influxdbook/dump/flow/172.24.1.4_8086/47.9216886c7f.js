(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{105:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return i}));const r=e=>e.startsWith("_"),o=475,a=1,s="create-a-bucket",i={id:s,name:"+ Create A Bucket"}},119:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n(2),o=n.n(r),a=n(4),s=n(3),i=n(138),l=n(12),c=n(11);const u=Object(r.createContext)({variables:{},update:e=>{},transform:e=>e}),d=(e,t)=>new Function("vars","var output="+JSON.stringify(e).replace(/<%=(.+?)%>/g,'"+(vars["$1".trim()])+"')+";return output;")(t),p=({variables:e,children:t})=>{const[n,a]=Object(r.useState)(e||{});return Object(r.useEffect)(()=>{e&&a(e)},[e]),o.a.createElement(u.Provider,{value:{variables:n,update:a,transform:e=>d(e,n)}},t)};t.c=({text:e,label:t,testID:n,type:d,onCopy:p})=>{const{transform:m}=Object(r.useContext)(u),g=Object(a.d)(),f=m(e);return o.a.createElement("div",{className:"code-snippet","data-testid":n||"code-snippet"},o.a.createElement(s.DapperScrollbars,{autoHide:!1,autoSizeHeight:!0,className:"code-snippet--scroll"},o.a.createElement("div",{className:"code-snippet--text"},o.a.createElement("pre",null,o.a.createElement("code",null,f)))),o.a.createElement("div",{className:"code-snippet--footer"},o.a.createElement(i.a,{text:f,onCopy:()=>{"function"==typeof p&&p(),g(Object(c.c)(Object(l.X)(`${f.slice(0,30).trimRight()}...`,null!=d?d:"Script")))}}),t&&o.a.createElement("label",{className:"code-snippet--label"},t)))}},138:function(e,t,n){"use strict";var r=n(2),o=n.n(r),a=n(95),s=n.n(a),i=n(3);class l extends r.PureComponent{constructor(){super(...arguments),this.handleClickCopy=e=>{e.stopPropagation(),e.preventDefault()},this.handleCopyAttempt=()=>{const{onCopy:e}=this.props;e&&e()}}render(){const{text:e,testID:t,size:n}=this.props;return o.a.createElement(s.a,{text:e,onCopy:this.handleCopyAttempt},o.a.createElement(i.Button,{shape:i.ButtonShape.Default,size:n||i.ComponentSize.ExtraSmall,color:i.ComponentColor.Secondary,titleText:"Copy to Clipboard",text:"Copy to Clipboard",onClick:this.handleClickCopy,testID:null!=t?t:"button-copy"}))}}t.a=l},150:function(e,t,n){"use strict";var r=n(10),o=n(2),a=n.n(o),s=n(7),i=n(3),l=n(14),c=n(54);let u=class extends o.Component{constructor(e){super(e),this.handleSearch=()=>{this.props.onSearch(this.state.searchTerm)},this.handleBlur=e=>{this.setState({searchTerm:e.target.value},this.handleSearch)},this.handleChange=e=>{this.setState({searchTerm:e.target.value},this.handleSearch)},this.state={searchTerm:this.props.searchTerm}}componentDidUpdate(e){this.props.searchTerm!==e.searchTerm&&this.setState({searchTerm:this.props.searchTerm})}UNSAFE_componentWillMount(){this.handleSearch=Object(s.debounce)(this.handleSearch,50)}render(){const{placeholderText:e,testID:t}=this.props,{searchTerm:n}=this.state;return a.a.createElement(c.a,null,a.a.createElement(i.Input,{icon:i.IconFont.Search,placeholder:e,value:n,onChange:this.handleChange,onBlur:this.handleBlur,testID:t,className:"search-widget-input"}))}};u.defaultProps={widthPixels:440,placeholderText:"Search...",searchTerm:"",testID:"search-widget"},u=Object(r.a)([l.a,Object(r.b)("design:paramtypes",[Object])],u),t.a=u},152:function(e,t,n){"use strict";var r=n(2),o=n(6);t.a=class extends r.PureComponent{render(){const{children:e}=this.props;return o.f?null:e}}},174:function(e,t,n){"use strict";n.d(t,"l",(function(){return C})),n.d(t,"e",(function(){return O})),n.d(t,"p",(function(){return v})),n.d(t,"n",(function(){return I})),n.d(t,"q",(function(){return x})),n.d(t,"a",(function(){return j})),n.d(t,"h",(function(){return A})),n.d(t,"k",(function(){return k})),n.d(t,"o",(function(){return N})),n.d(t,"d",(function(){return w})),n.d(t,"b",(function(){return R})),n.d(t,"c",(function(){return P})),n.d(t,"i",(function(){return L})),n.d(t,"f",(function(){return K})),n.d(t,"g",(function(){return F})),n.d(t,"j",(function(){return $})),n.d(t,"m",(function(){return B}));var r=n(7),o=n(25),a=n(39),s=n(285),i=n(334),l=n(46),c=n(294),u=n(665),d=n(329),p=n(221),m=n(13),g=n(9),f=n(8),h=n(526),y=n(284),b=n(5),E=n(314),D=n(333),S=n(11),T=n(12);const C=e=>({type:"SET_DATA_LOADERS_TYPE",payload:{type:e}}),O=()=>({type:"CLEAR_DATA_LOADERS"}),v=e=>({type:"SET_TELEGRAF_CONFIG_NAME",payload:{name:e}}),I=e=>({type:"SET_TELEGRAF_CONFIG_DESCRIPTION",payload:{description:e}}),x=(e,t,n)=>({type:"UPDATE_TELEGRAF_PLUGIN_CONFIG",payload:{name:e,field:t,value:n}}),j=(e,t,n)=>({type:"ADD_TELEGRAF_PLUGIN_CONFIG_VALUE",payload:{pluginName:e,fieldName:t,value:n}}),A=(e,t,n)=>({type:"REMOVE_TELEGRAF_PLUGIN_CONFIG_VALUE",payload:{pluginName:e,fieldName:t,value:n}}),k=(e,t,n,r)=>({type:"SET_TELEGRAF_PLUGIN_CONFIG_VALUE",payload:{pluginName:e,field:t,valueIndex:n,value:r}}),N=e=>({type:"SET_TELEGRAF_CONFIG_ID",payload:{id:e}}),w=e=>({type:"ADD_TELEGRAF_PLUGINS",payload:{telegrafPlugins:e}}),_=e=>({type:"SET_TOKEN",payload:{token:e}}),R=e=>t=>{t((e=>({type:"ADD_PLUGIN_BUNDLE",payload:{bundle:e}}))(e));const n=h.d[e];t(w(n.map(e=>({name:e,active:!1,configured:h.e[e].fields?y.d.Unconfigured:y.d.Configured,templateID:h.e[e].templateID}))))},P=e=>t=>{t((e=>({type:"ADD_TELEGRAF_telegrafUiRefresh",payload:{plugin:e}}))(e)),t({type:"ADD_TELEGRAF_PLUGINS_telegrafUiRefresh",payload:{telegrafPlugins:e}})},L=e=>t=>{t((e=>({type:"REMOVE_PLUGIN_BUNDLE",payload:{bundle:e}}))(e)),t((e=>({type:"REMOVE_BUNDLE_PLUGINS",payload:{bundle:e}}))(e))},K=()=>async(e,t)=>{const{telegrafPlugins:n,telegrafConfigID:r,telegrafConfigName:i,telegrafConfigDescription:l}=Object(d.a)(t()),{name:p}=Object(g.a)(t()),{bucket:m}=Object(d.b)(t()),h={name:s.y.NameEnum.InfluxdbV2,type:s.y.TypeEnum.Output,config:{urls:[`${window.location.origin}`],token:"$INFLUX_TOKEN",organization:p,bucket:m}},b=n.reduce((e,t)=>t.configured===y.d.Configured?[...e,t.plugin||Object(u.a)(t)]:e,[h]);if(r){const t=await a.a.telegrafConfigs.update(r,{name:i,description:l,plugins:b}),n=Object(o.a)(t,c.b);return e(Object(E.g)(n)),e(N(r)),void Object(f.a)(`telegraf.config.${Object(f.c)(i)}.edit.success`,{id:null==t?void 0:t.id})}U(e,t,b)},F=e=>async(t,n)=>{let o="",a="";try{const l=n(),c=Object(g.a)(l).id,u=Object(m.f)(l,b.ResourceType.Telegrafs,e);if(o=u.name,a=Object(r.get)(u,"metadata.buckets[0]",""),""===a)throw new Error("An API token cannot be generated without a corresponding bucket; no buckets are assigned");const d=Object(p.a)(l,a);if(!d||!d.id)throw new Error(`there is no bucket present with name ${a}`);const h=[{action:s.b.ActionEnum.Write,resource:{type:s.c.TypeEnum.Buckets,id:d.id,orgID:c}},{action:s.b.ActionEnum.Read,resource:{type:s.c.TypeEnum.Telegrafs,id:e,orgID:c}}],y={name:`${u.name} token`,orgID:c,description:`WRITE ${a} bucket / READ ${u.name} telegraf config`,permissions:h},E=await Object(i.a)(y);Object(f.a)("token.create.success",{name:o,bucket:a}),t(_(E.token))}catch(e){if(console.error(e),Object(f.a)("token.create.failure",{name:o,bucket:a}),e.message){const n=Object.assign(Object.assign({},T.l),{message:`${T.l.message}: ${e.message}`});t(Object(S.c)(n))}else t(Object(S.c)(T.l))}},U=async(e,t,n)=>{let r="",u="";try{const p=t(),{telegrafConfigName:m,telegrafConfigDescription:h}=Object(d.a)(p);r=m;const{bucket:y,bucketID:b}=Object(d.b)(p);u=y;const C=Object(g.a)(t()),O={name:m,description:h,agent:{collectionInterval:1e4},orgID:C.id,plugins:n},v=await a.a.telegrafConfigs.create(O),I=[{action:s.b.ActionEnum.Write,resource:{type:s.c.TypeEnum.Buckets,id:b,orgID:C.id}},{action:s.b.ActionEnum.Read,resource:{type:s.c.TypeEnum.Telegrafs,id:v.id,orgID:C.id}}],x={name:`${m} token`,orgID:C.id,description:`WRITE ${y} bucket / READ ${m} telegraf config`,permissions:I},j=await Object(i.a)(x);e(_(j.token));const A=Object(o.a)(j,l.h);e(Object(D.g)(A));const k=Object(o.a)(v,c.b);e(N(v.id)),e(Object(E.f)(k)),e(Object(S.c)(T.i)),Object(f.a)(`telegraf.config.${Object(f.c)(r)}.create.success`,{id:v.id,bucket:u})}catch(t){Object(f.a)(`telegraf.config.${Object(f.c)(r)}.create.failure`,{bucket:u}),console.error(t.message),e(Object(S.c)(T.h))}},$=e=>({type:"SET_ACTIVE_TELEGRAF_PLUGIN",payload:{telegrafPlugin:e}}),B=e=>({type:"SET_PLUGIN_CONFIGURATION_STATE",payload:{telegrafPlugin:e}})},178:function(e,t,n){"use strict";var r=n(2),o=n.n(r),a=n(3),s=n(109),i=n(5);t.a=function({sortDirection:e,sortKey:t,sortType:n,onSelect:r,resourceType:l,width:c=210}){const u=(e=>{switch(e){case i.ResourceType.Dashboards:return[{label:"Name (A → Z)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Name (Z → A)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Descending},{label:"Modified (Oldest)",sortKey:"meta.updatedAt",sortType:s.a.Date,sortDirection:a.Sort.Ascending},{label:"Modified (Newest)",sortKey:"meta.updatedAt",sortType:s.a.Date,sortDirection:a.Sort.Descending}];case i.ResourceType.Tasks:return[{label:"Name (A → Z)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Name (Z → A)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Descending},{label:"Active",sortKey:"status",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Inactive",sortKey:"status",sortType:s.a.String,sortDirection:a.Sort.Descending},{label:"Completed (Oldest)",sortKey:"latestCompleted",sortType:s.a.Date,sortDirection:a.Sort.Ascending},{label:"Completed (Newest)",sortKey:"latestCompleted",sortType:s.a.Date,sortDirection:a.Sort.Descending},{label:"Schedule (Most Often)",sortKey:"every",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Schedule (Least Often)",sortKey:"every",sortType:s.a.String,sortDirection:a.Sort.Descending}];case i.ResourceType.Variables:return[{label:"Name (A → Z)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Name (Z → A)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Descending},{label:"Type (A → Z)",sortKey:"arguments.type",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Type (Z → A)",sortKey:"arguments.type",sortType:s.a.String,sortDirection:a.Sort.Descending}];case i.ResourceType.Secrets:return[{label:"Name (A → Z)",sortKey:"id",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Name (Z → A)",sortKey:"id",sortType:s.a.String,sortDirection:a.Sort.Descending}];case i.ResourceType.Labels:return[{label:"Name (A → Z)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Name (Z → A)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Descending},{label:"Description (A → Z)",sortKey:"properties.description",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Description (Z → A)",sortKey:"properties.description",sortType:s.a.String,sortDirection:a.Sort.Descending}];case i.ResourceType.Templates:return[{label:"Name (A → Z)",sortKey:"meta.name",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Name (Z → A)",sortKey:"meta.name",sortType:s.a.String,sortDirection:a.Sort.Descending},{label:"Description (A → Z)",sortKey:"meta.description",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Description (Z → A)",sortKey:"meta.description",sortType:s.a.String,sortDirection:a.Sort.Descending}];case i.ResourceType.Buckets:return[{label:"Name (A → Z)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Name (Z → A)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Descending},{label:"Retention (Ascending)",sortKey:"retentionRules[0].everySeconds",sortType:s.a.Float,sortDirection:a.Sort.Ascending},{label:"Retention (Descending)",sortKey:"retentionRules[0].everySeconds",sortType:s.a.Float,sortDirection:a.Sort.Descending}];case i.ResourceType.Telegrafs:return[{label:"Name (A → Z)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Name (Z → A)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Descending},{label:"Description (Ascending)",sortKey:"description",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Description (Descending)",sortKey:"description",sortType:s.a.String,sortDirection:a.Sort.Descending}];case i.ResourceType.Scrapers:return[{label:"Name (A → Z)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Name (Z → A)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Descending},{label:"URL (Ascending)",sortKey:"url",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"URL (Descending)",sortKey:"url",sortType:s.a.String,sortDirection:a.Sort.Descending},{label:"Bucket (Ascending)",sortKey:"bucket",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Bucket (Descending)",sortKey:"bucket",sortType:s.a.String,sortDirection:a.Sort.Descending}];case i.ResourceType.Authorizations:return[{label:"Description (A → Z)",sortKey:"description",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Description (Z → A)",sortKey:"description",sortType:s.a.String,sortDirection:a.Sort.Descending},{label:"Status (Active)",sortKey:"status",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Status (Inactive)",sortKey:"status",sortType:s.a.String,sortDirection:a.Sort.Descending},{label:"Date Created (Oldest)",sortKey:"createdAt",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Date Created (Newest)",sortKey:"createdAt",sortType:s.a.String,sortDirection:a.Sort.Descending}];case i.ResourceType.Flows:return[{label:"Name (A → Z)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Ascending},{label:"Name (Z → A)",sortKey:"name",sortType:s.a.String,sortDirection:a.Sort.Descending},{label:"Created (Oldest)",sortKey:"createdAt",sortType:s.a.Date,sortDirection:a.Sort.Ascending},{label:"Created (Newest)",sortKey:"createdAt",sortType:s.a.Date,sortDirection:a.Sort.Descending}]}})(l),{label:d}=u.find(r=>r.sortKey===t&&r.sortDirection===e&&r.sortType===n),p=e=>{const{sortKey:t,sortDirection:n,sortType:o}=e;r(t,n,o)};return o.a.createElement(a.Dropdown,{button:(e,t)=>o.a.createElement(a.Dropdown.Button,{onClick:t,active:e,testID:"resource-sorter--button"},`Sort by ${d}`),menu:r=>o.a.createElement(a.Dropdown.Menu,{onCollapse:r},u.map(r=>o.a.createElement(a.Dropdown.Item,{key:`${r.sortKey}${r.sortDirection}`,value:r,onClick:p,testID:`resource-sorter--${r.sortKey}-${r.sortDirection}`,selected:r.sortKey===t&&r.sortType===n&&r.sortDirection===e},r.label))),style:{flexBasis:`${c}px`,width:`${c}px`},testID:"resource-sorter"})}},221:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(5),o=n(13);const a=(e,t)=>Object(o.a)(e,r.ResourceType.Buckets).find(e=>e.name===t),s=(e,t)=>{const n=`${e.name}`.toLowerCase(),r=`${t.name}`.toLowerCase();return n===r?0:n<r?-1:n>r?1:0},i=e=>{const t=[],n=[];return Object(o.a)(e,r.ResourceType.Buckets).forEach(e=>{"system"===e.type?t.push(e):n.push(e)}),t.sort(s),n.sort(s),n.concat(t)}},229:function(e,t,n){"use strict";var r=n(2),o=n.n(r);t.a=({childrenLeft:e,childrenRight:t,width:n})=>{let r=o.a.createElement(o.a.Fragment,null),a=o.a.createElement(o.a.Fragment,null);return e&&(r=o.a.createElement("div",{className:"tabbed-page--header-left"},e)),t&&(a=o.a.createElement("div",{className:"tabbed-page--header-right"},t)),n?o.a.createElement("div",{className:"tabbed-page--header","data-testid":"tabbed-page--header",style:{width:n}},r,a):o.a.createElement("div",{className:"tabbed-page--header","data-testid":"tabbed-page--header"},r,a)}},2507:function(e,t,n){"use strict";n.r(t);var r=n(10),o=n(2),a=n.n(o),s=n(155),i=n(14),l=n(331),c=n(328),u=n(7),d=n(4),p=n(3),m=n(150),g=n(229),f=n(337),h=n(20),y=n(82),b=n(361),E=n(158),D=n(9),S=n(129),T=n(74);class C extends o.PureComponent{constructor(){super(...arguments),this.handleUpdateName=e=>{const{onUpdate:t,collector:n}=this.props;t(Object.assign(Object.assign({},n),{name:e}))},this.handleUpdateDescription=e=>{const{onUpdate:t,collector:n}=this.props;t(Object.assign(Object.assign({},n),{description:e}))},this.handleAddLabel=async e=>{const{collector:t,onAddLabels:n}=this.props;await n(t.id,[e])},this.handleRemoveLabel=async e=>{const{collector:t,onRemoveLabels:n}=this.props;await n(t.id,[e])},this.handleNameClick=e=>{e.preventDefault(),this.handleOpenConfig()},this.handleOpenConfig=()=>{const{collector:e,history:t,org:n}=this.props;t.push(`/orgs/${n.id}/load-data/telegrafs/${e.id}/view`)},this.cloneTelegraf=()=>{const e=Object.values(this.props.telegrafs).map(e=>e.name);this.props.onCloneTelegraf(Object.assign(Object.assign({},this.props.collector),{name:Object(T.a)(e,this.props.collector.name)}))},this.handleDeleteConfig=()=>{this.props.onDelete(this.props.collector)}}render(){const{collector:e,org:t}=this.props;return a.a.createElement(p.ResourceCard,{key:`telegraf-id--${e.id}`,testID:"resource-card",contextMenu:this.contextMenu},a.a.createElement(p.ResourceCard.EditableName,{onUpdate:this.handleUpdateName,onClick:this.handleNameClick,name:e.name,noNameString:S.d,testID:"collector-card--name",buttonTestID:"collector-card--name-button",inputTestID:"collector-card--input"}),a.a.createElement(p.ResourceCard.EditableDescription,{onUpdate:this.handleUpdateDescription,description:e.description,placeholder:`Describe ${e.name}`}),a.a.createElement(p.ResourceCard.Meta,null,a.a.createElement("span",{key:`bucket-key--${e.id}`,"data-testid":"bucket-name"},"Bucket: ",e.metadata.buckets.join(", ")),a.a.createElement(h.a,{to:`/orgs/${t.id}/load-data/telegrafs/${e.id}/instructions`,"data-testid":"setup-instructions-link"},"Setup Instructions")),this.labels)}get contextMenu(){return a.a.createElement(y.e,null,a.a.createElement(y.e.Menu,{icon:p.IconFont.Duplicate,color:p.ComponentColor.Secondary,testID:"telegraf-clone-menu"},a.a.createElement(y.e.Item,{label:"Clone",action:this.cloneTelegraf,testID:"telegraf-clone-button"})),a.a.createElement(y.e.Menu,{testID:"telegraf-delete-menu",icon:p.IconFont.Trash,color:p.ComponentColor.Danger},a.a.createElement(y.e.Item,{testID:"telegraf-delete-button",label:"Delete",action:this.handleDeleteConfig})))}get labels(){const{collector:e,onFilterChange:t}=this.props;return a.a.createElement(b.a,{selectedLabelIDs:e.labels,onFilterChange:t,onAddLabel:this.handleAddLabel,onRemoveLabel:this.handleRemoveLabel})}}const O={onCloneTelegraf:E.b,onAddLabels:E.a,onRemoveLabels:E.e};var v=Object(d.c)(e=>({org:Object(D.a)(e),telegrafs:e.resources.telegrafs.byID}),O)(Object(s.j)(C)),I=n(148),x=n(109),j=n(5),A=n(13);class k extends o.PureComponent{constructor(){super(...arguments),this.memGetSortedResources=Object(f.a)(x.b)}render(){const{emptyState:e}=this.props;return a.a.createElement(p.ResourceList,null,a.a.createElement(p.ResourceList.Body,{emptyState:e},this.collectorsList))}get collectorsList(){const{collectors:e,sortKey:t,sortDirection:n,sortType:r,onDeleteTelegraf:o,onUpdateTelegraf:s,onFilterChange:i}=this.props,l=this.memGetSortedResources(e,t,n,r);if(void 0!==e)return l.map(e=>a.a.createElement(v,{key:e.id,collector:e,onDelete:e=>o(e.id,e.name),onUpdate:s,onFilterChange:i}))}}const N={onUpdateTelegraf:E.f,onDeleteTelegraf:E.c},w=Object(I.a)();class _ extends o.PureComponent{render(){const{searchTerm:e,collectors:t,emptyState:n,onFilterChange:r,sortKey:o,sortDirection:s,sortType:i,onUpdateTelegraf:l,onDeleteTelegraf:c}=this.props;return a.a.createElement(w,{searchTerm:e,searchKeys:["metadata.buckets[]","name","labels[].name"],list:t},e=>a.a.createElement(k,{collectors:e,emptyState:n,onFilterChange:r,sortKey:o,sortDirection:s,sortType:i,onUpdateTelegraf:l,onDeleteTelegraf:c}))}}const R=Object(d.c)(e=>({collectors:Object(A.a)(e,j.ResourceType.Telegrafs)}),N)(_);var P=n(72);var L=({hasNoTelegrafs:e=!1,textAlign:t="inherit",bodySize:n})=>a.a.createElement(p.Panel,{gradient:p.Gradients.PolarExpress,border:!0,style:{textAlign:t}},e&&a.a.createElement(p.EmptyState.Text,{style:{color:p.InfluxColors.Platinum,marginTop:16}},"What is Telegraf?"),!e&&a.a.createElement(p.Panel.Header,null,a.a.createElement("h5",null,"What is Telegraf?")),a.a.createElement(p.Panel.Body,{size:n},"Telegraf is an agent written in Go for collecting metrics and writing them into ",a.a.createElement("strong",null,"InfluxDB")," or other possible outputs.",a.a.createElement("br",null),a.a.createElement("br",null),"Here's a handy guide for"," ",a.a.createElement("a",{href:`https://docs.influxdata.com/influxdb/${P.a}/write-data/no-code/use-telegraf/`,target:"_blank",rel:"noreferrer"},"Getting Started with Telegraf"))),K=n(964),F=n(88),U=n(178),$=n(174),B=n(8);let G=class extends o.PureComponent{constructor(e){super(e),this.handleSort=(e,t,n)=>{this.setState({sortKey:e,sortDirection:t,sortType:n})},this.handleAddCollector=()=>{const{history:e,match:{params:{orgID:t}}}=this.props;e.push(`/orgs/${t}/load-data/telegrafs/new`),Object(B.a)("load_data.telegrafs.create_new_configuration.clicked")},this.handleJustTheOutput=()=>{const{history:e,match:{params:{orgID:t}}}=this.props;e.push(`/orgs/${t}/load-data/telegrafs/output`),Object(B.a)("load_data.telegrafs.influxdb_output_plugin_button.clicked")},this.handleFilterChange=e=>{this.handleFilterUpdate(e)},this.handleFilterUpdate=e=>{this.setState({searchTerm:e})},this.state={dataLoaderOverlay:j.OverlayState.Closed,searchTerm:"",instructionsOverlay:j.OverlayState.Closed,collectorID:null,sortKey:"name",sortDirection:p.Sort.Ascending,sortType:x.a.String}}render(){const{hasTelegrafs:e}=this.props,{searchTerm:t,sortKey:n,sortDirection:r,sortType:o}=this.state,s=a.a.createElement(a.a.Fragment,null,a.a.createElement(m.a,{placeholderText:"Filter telegraf configurations...",searchTerm:t,onSearch:this.handleFilterChange}),a.a.createElement(U.a,{resourceType:j.ResourceType.Telegrafs,sortDirection:r,sortKey:n,sortType:o,onSelect:this.handleSort})),i=a.a.createElement(a.a.Fragment,null,a.a.createElement(p.Button,{text:"InfluxDB Output Plugin",icon:p.IconFont.Eye,color:p.ComponentColor.Secondary,onClick:this.handleJustTheOutput,titleText:"Output section of telegraf.conf for V2",testID:"button--output-only"}),this.createButton);return a.a.createElement(a.a.Fragment,null,a.a.createElement(K.a,{visible:this.hasNoBuckets,resourceName:"Telegraf Configurations"}),a.a.createElement(g.a,{childrenLeft:s,childrenRight:i}),a.a.createElement(p.Grid,null,a.a.createElement(p.Grid.Row,null,a.a.createElement(p.Grid.Column,{widthXS:p.Columns.Twelve,widthSM:e?p.Columns.Eight:p.Columns.Twelve,widthMD:e?p.Columns.Ten:p.Columns.Twelve},a.a.createElement(F.a,{resources:[j.ResourceType.Labels]},a.a.createElement(R,{searchTerm:t,emptyState:this.emptyState,onFilterChange:this.handleFilterUpdate,sortKey:n,sortDirection:r,sortType:o}))),e&&a.a.createElement(p.Grid.Column,{widthXS:p.Columns.Twelve,widthSM:p.Columns.Four,widthMD:p.Columns.Two},a.a.createElement(L,null)))))}get hasNoBuckets(){const{buckets:e}=this.props;return!e||!e.length}get createButton(){let e=p.ComponentStatus.Default,t="Create a new Telegraf Configuration";return this.hasNoBuckets&&(e=p.ComponentStatus.Disabled,t="You need at least 1 bucket in order to create a Telegraf Configuration"),a.a.createElement(p.Button,{text:"Create Configuration",icon:p.IconFont.Plus,color:p.ComponentColor.Primary,onClick:this.handleAddCollector,status:e,titleText:t,testID:"create-telegraf-configuration-button"})}get emptyState(){const{orgName:e}=this.props,{searchTerm:t}=this.state;return Object(u.isEmpty)(t)?a.a.createElement(p.EmptyState,{size:p.ComponentSize.Medium},a.a.createElement(p.EmptyState.Text,null,`${e}`," does not own any ",a.a.createElement("b",null,"Telegraf Configurations"),", why not create one?"),this.createButton,a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(L,{hasNoTelegrafs:!0,textAlign:"center",bodySize:p.ComponentSize.Medium})):a.a.createElement(p.EmptyState,{size:p.ComponentSize.Medium},a.a.createElement(p.EmptyState.Text,null,"No ",a.a.createElement("b",null,"Telegraf Configurations")," match your query"))}};G=Object(r.a)([i.a,Object(r.b)("design:paramtypes",[Object])],G);const M={onSetTelegrafConfigID:$.o,onSetTelegrafConfigName:$.p,onClearDataLoaders:$.e,onUpdateTelegraf:E.f,onDeleteTelegraf:E.c};var Z=Object(d.c)(e=>{const{telegrafs:t}=e.resources,n=Object(D.a)(e).name,r=Object(A.a)(e,j.ResourceType.Buckets);return{hasTelegrafs:!!t.allIDs.length,orgName:n,buckets:r}},M)(Object(s.j)(G)),V=n(373),z=n(656);let W=class extends o.PureComponent{constructor(){super(...arguments),this.handleDismiss=()=>{const{history:e,match:{params:{orgID:t}},onClearDataLoaders:n}=this.props;this.setState({collectorID:null}),n(),e.push(`/orgs/${t}/load-data/telegrafs/`)}}render(){const{token:e}=this.props;return a.a.createElement(p.Overlay,{visible:!0},a.a.createElement(p.Overlay.Container,{maxWidth:700},a.a.createElement(p.Overlay.Header,{title:"Telegraf Setup Instructions",onDismiss:this.handleDismiss}),a.a.createElement(p.Overlay.Body,null,a.a.createElement(F.a,{resources:[j.ResourceType.Authorizations]},a.a.createElement(z.a,{token:e,configID:Object(u.get)(this.collector,"id","")})))))}get collector(){const{match:{params:{id:e}},collectors:t}=this.props;return t.find(t=>t.id===e)}};W=Object(r.a)([i.a],W);const H={onClearDataLoaders:$.e};var X=Object(d.c)(e=>{const{me:{name:t}}=e;return{username:t,token:Object(A.i)(e),collectors:Object(A.a)(e,j.ResourceType.Telegrafs)}},H)(Object(s.j)(W)),q=n(741),Y=n(515),J=n.n(Y),Q=n(286),ee=n(965),te=n(11),ne=n(304),re=n(105);const oe=J()({loader:()=>Promise.all([n.e(12),n.e(18),n.e(67)]).then(n.bind(null,2602)),loading:()=>a.a.createElement(Q.a,null)});let ae=class extends o.PureComponent{constructor(){super(...arguments),this.state={pluginConfig:"",isValidConfiguration:!1,isVisible:!0},this.handleDismiss=()=>{const{history:e,org:t}=this.props,{clearDataLoaders:n,onClearSteps:r}=this.props;n(),r(),this.setState({isVisible:!1}),e.push(`/orgs/${t.id}/load-data/telegrafs`)},this.handleSetIsValidConfiguration=e=>{this.setState({isValidConfiguration:e})},this.handleSetPluginConfig=e=>{this.setState({pluginConfig:e})}}componentDidMount(){this.props.clearDataLoaders(),this.props.onSetCurrentStepIndex(0),this.props.onSetSubstepIndex(0,0),this.props.setBucketInfo("","","")}render(){const{currentStepIndex:e,substepIndex:t}=this.props;let n="data-loading--overlay",r=1200;return 0===e&&1===t&&(r=re.b),(0===e&&1===t||1===e)&&(n=""),a.a.createElement(p.Overlay,{visible:this.state.isVisible},a.a.createElement(p.Overlay.Container,{maxWidth:r},a.a.createElement(p.Overlay.Header,{title:"Create a Telegraf Configuration",onDismiss:this.handleDismiss}),a.a.createElement(p.Overlay.Body,{className:n},a.a.createElement(oe,{stepProps:this.stepProps})),a.a.createElement(ee.a,Object.assign({},this.stepProps))))}get stepProps(){const{currentStepIndex:e,notify:t,onDecrementCurrentStepIndex:n,onIncrementCurrentStepIndex:r,onSetSubstepIndex:o,substepIndex:a,telegrafPlugins:s}=this.props,i=(null==s?void 0:s.length)?s[0].name:"";return{currentStepIndex:e,isValidConfiguration:this.state.isValidConfiguration,notify:t,onDecrementCurrentStepIndex:n,onExit:this.handleDismiss,onIncrementCurrentStepIndex:r,onSetSubstepIndex:o,pluginConfig:this.state.pluginConfig,pluginConfigName:i,setIsValidConfiguration:this.handleSetIsValidConfiguration,setPluginConfig:this.handleSetPluginConfig,substepIndex:a}}};ae=Object(r.a)([i.a],ae);const se={notify:te.c,clearDataLoaders:$.e,onClearSteps:ne.a,onDecrementCurrentStepIndex:ne.b,onIncrementCurrentStepIndex:ne.c,onSetCurrentStepIndex:ne.e,onSetSubstepIndex:ne.f,setBucketInfo:ne.d};var ie=Object(d.c)(e=>{const{dataLoading:{dataLoaders:{telegrafPlugins:t},steps:{currentStep:n,substep:r=0,bucket:o}},me:{name:a},telegrafEditor:s}=e,i=Object(A.a)(e,j.ResourceType.Buckets).filter(e=>!Object(re.e)(e.name)),l=Object(D.a)(e);return{telegrafPlugins:t,text:s.text,currentStepIndex:n,substepIndex:"number"==typeof r?r:0,username:a,bucket:o,buckets:i,org:l}},se)(Object(s.j)(ae)),le=n(327),ce=n(64),ue=n(23),de=n(203);const pe=Object(le.a)(le.b,"telegraf-config",(e,t)=>{e.push(`/orgs/${t.orgID}/load-data/telegrafs`)}),me=Object(le.a)(le.b,"telegraf-output",(e,t)=>{e.push(`/orgs/${t.orgID}/load-data/telegrafs`)}),ge=`/${de.m}/${de.n}/load-data/${de.s}`;let fe=class extends o.PureComponent{render(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(p.Page,{titleTag:Object(ce.a)(["Telegraf","Load Data"])},a.a.createElement(V.a,null,a.a.createElement(c.a,null),a.a.createElement(l.a,{activeTab:"telegrafs"},a.a.createElement(F.a,{resources:[j.ResourceType.Buckets,j.ResourceType.Telegrafs]},a.a.createElement(Z,null))))),a.a.createElement(s.c,null,a.a.createElement(s.a,{path:`${ge}/:id/view`,component:pe}),a.a.createElement(s.a,{path:`${ge}/:id/instructions`,component:X}),a.a.createElement(s.a,{path:`${ge}/output`,component:me}),a.a.createElement(s.a,{path:`${ge}/new`,component:Object(ue.c)("telegrafUiRefresh")?ie:q.a})))}};fe=Object(r.a)([i.a],fe);t.default=fe},299:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyToClipboard=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=i(n(2)),s=i(n(300));function i(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(t.CopyToClipboard=function(e){function t(){var e,n,r;l(this,t);for(var o=arguments.length,i=Array(o),u=0;u<o;u++)i[u]=arguments[u];return n=r=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.onClick=function(e){var t=r.props,n=t.text,o=t.onCopy,i=t.children,l=t.options,c=a.default.Children.only(i),u=(0,s.default)(n,l);o&&o(n,u),c&&c.props&&"function"==typeof c.props.onClick&&c.props.onClick(e)},c(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=(e.text,e.onCopy,e.options,e.children),n=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["text","onCopy","options","children"]),o=a.default.Children.only(t);return a.default.cloneElement(o,r({},n,{onClick:this.onClick}))}}]),t}(a.default.PureComponent)).defaultProps={onCopy:void 0,options:void 0}},300:function(e,t,n){"use strict";var r=n(301);e.exports=function(e,t){var n,o,a,s,i,l,c=!1;t||(t={}),n=t.debug||!1;try{if(a=r(),s=document.createRange(),i=document.getSelection(),(l=document.createElement("span")).textContent=e,l.style.all="unset",l.style.position="fixed",l.style.top=0,l.style.clip="rect(0, 0, 0, 0)",l.style.whiteSpace="pre",l.style.webkitUserSelect="text",l.style.MozUserSelect="text",l.style.msUserSelect="text",l.style.userSelect="text",document.body.appendChild(l),s.selectNode(l),i.addRange(s),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");c=!0}catch(r){n&&console.error("unable to copy using execCommand: ",r),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData("text",e),c=!0}catch(r){n&&console.error("unable to copy using clipboardData: ",r),n&&console.error("falling back to prompt"),o=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(o,e)}}finally{i&&("function"==typeof i.removeRange?i.removeRange(s):i.removeAllRanges()),l&&document.body.removeChild(l),a()}return c}},301:function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],r=0;r<e.rangeCount;r++)n.push(e.getRangeAt(r));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},304:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return l}));const r=()=>({type:"CLEAR_STEPS"}),o=()=>({type:"INCREMENT_CURRENT_STEP_INDEX"}),a=()=>({type:"DECREMENT_CURRENT_STEP_INDEX"}),s=e=>({type:"SET_CURRENT_STEP_INDEX",payload:{index:e}}),i=(e,t)=>({type:"SET_SUBSTEP_INDEX",payload:{stepIndex:e,substep:t}}),l=(e,t,n)=>({type:"SET_BUCKET_INFO",payload:{orgID:e,bucket:t,bucketID:n}})},327:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),o=n.n(r),a=n(155),s=n(4),i=n(35);const l=Object(a.j)(e=>{const{overlayID:t,onClose:n,match:o,history:a}=e,l=Object(s.d)();return Object(r.useEffect)(()=>(l(Object(i.d)(t,o.params,()=>{n(a,o.params)})),()=>l(Object(i.b)())),[t]),null});function c(e,t,n){return class extends r.Component{render(){return o.a.createElement(e,Object.assign({},this.props,{onClose:n,overlayID:t}))}}}t.b=l},328:function(e,t,n){"use strict";var r=n(2),o=n.n(r),a=n(3),s=n(87);t.a=()=>o.a.createElement(a.Page.Header,{fullWidth:!1,testID:"load-data--header"},o.a.createElement(a.Page.Title,{title:"Load Data"}),o.a.createElement(s.a,null))},329:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));const r=e=>e.dataLoading.dataLoaders,o=e=>e.dataLoading.steps},331:function(e,t,n){"use strict";var r=n(2),o=n.n(r),a=n(4),s=n(54),i=n(10),l=n(155),c=n(3),u=n(23),d=n(14),p=n(152);let m=class extends r.PureComponent{render(){const{activeTab:e,orgID:t,history:n}=this.props,r=e=>{n.push(`/orgs/${t}/load-data/${e}`)},a=[{text:"Sources",id:"sources",cloudExclude:!1,featureFlag:null},{text:"Buckets",id:"buckets",cloudExclude:!1,featureFlag:null},{text:"Telegraf",id:"telegrafs",cloudExclude:!1,featureFlag:null},{text:"Scrapers",id:"scrapers",cloudExclude:!0,featureFlag:null},{text:"API Tokens",id:"tokens",cloudExclude:!1,featureFlag:null}],s=a.find(t=>t.id===e).text;return o.a.createElement(c.Tabs,{orientation:c.Orientation.Horizontal,size:c.ComponentSize.Large,dropdownBreakpoint:872,dropdownLabel:s},a.map(t=>{let n=o.a.createElement(c.Tabs.Tab,{testID:`${t.id}--tab`,key:t.id,text:t.text,id:t.id,onClick:r,active:t.id===e});return t.cloudExclude&&(n=o.a.createElement(p.a,{key:t.id},n)),t.featureFlag&&(n=o.a.createElement(u.a,{key:t.id,name:t.featureFlag},n)),n}))}};m=Object(i.a)([d.a],m);var g=Object(l.j)(m),f=n(9);const h=e=>("buckets"!==e||!Object(u.c)("fetchAllBuckets"))&&("tokens"!==e||!Object(u.c)("paginatedTokens")),y=Object(a.c)(e=>({orgID:Object(f.a)(e).id}));t.a=y(({activeTab:e,orgID:t,children:n})=>o.a.createElement(c.Page.Contents,{fullWidth:!1,scrollable:h(e)},o.a.createElement(c.Tabs.Container,{orientation:c.Orientation.Horizontal,stretchToFitHeight:!0},o.a.createElement(g,{activeTab:e,orgID:t}),o.a.createElement(s.a,null,o.a.createElement(c.Tabs.TabContents,null,n)))))},373:function(e,t,n){"use strict";var r=n(2),o=n(4),a=n(6);class s extends r.PureComponent{componentDidMount(){a.f&&this.props.getReadWriteCardinalityLimits()}render(){return this.props.children}}const i={getReadWriteCardinalityLimits:n(40).i},l=Object(o.c)(null,i);t.a=l(s)},515:function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=n(2),l=n(73),c=[],u=[];function d(e){var t=e(),n={loading:!0,loaded:null,error:null};return n.promise=t.then((function(e){return n.loading=!1,n.loaded=e,e})).catch((function(e){throw n.loading=!1,n.error=e,e})),n}function p(e){var t={loading:!1,loaded:{},error:null},n=[];try{Object.keys(e).forEach((function(r){var o=d(e[r]);o.loading?t.loading=!0:(t.loaded[r]=o.loaded,t.error=o.error),n.push(o.promise),o.promise.then((function(e){t.loaded[r]=e})).catch((function(e){t.error=e}))}))}catch(e){t.error=e}return t.promise=Promise.all(n).then((function(e){return t.loading=!1,e})).catch((function(e){throw t.loading=!1,e})),t}function m(e,t){return i.createElement((n=e)&&n.__esModule?n.default:n,t);var n}function g(e,t){var d,p;if(!t.loading)throw new Error("react-loadable requires a `loading` component");var g=Object.assign({loader:null,loading:null,delay:200,timeout:null,render:m,webpack:null,modules:null},t),f=null;function h(){return f||(f=e(g.loader)),f.promise}return c.push(h),"function"==typeof g.webpack&&u.push((function(){if(e=g.webpack,"object"===r(n.m)&&e().every((function(e){return void 0!==e&&void 0!==n.m[e]})))return h();var e})),p=d=function(t){function n(r){o(this,n);var s=a(this,t.call(this,r));return s.retry=function(){s.setState({error:null,loading:!0,timedOut:!1}),f=e(g.loader),s._loadModule()},h(),s.state={error:f.error,pastDelay:!1,timedOut:!1,loading:f.loading,loaded:f.loaded},s}return s(n,t),n.preload=function(){return h()},n.prototype.componentWillMount=function(){this._mounted=!0,this._loadModule()},n.prototype._loadModule=function(){var e=this;if(this.context.loadable&&Array.isArray(g.modules)&&g.modules.forEach((function(t){e.context.loadable.report(t)})),f.loading){"number"==typeof g.delay&&(0===g.delay?this.setState({pastDelay:!0}):this._delay=setTimeout((function(){e.setState({pastDelay:!0})}),g.delay)),"number"==typeof g.timeout&&(this._timeout=setTimeout((function(){e.setState({timedOut:!0})}),g.timeout));var t=function(){e._mounted&&(e.setState({error:f.error,loaded:f.loaded,loading:f.loading}),e._clearTimeouts())};f.promise.then((function(){t()})).catch((function(e){t()}))}},n.prototype.componentWillUnmount=function(){this._mounted=!1,this._clearTimeouts()},n.prototype._clearTimeouts=function(){clearTimeout(this._delay),clearTimeout(this._timeout)},n.prototype.render=function(){return this.state.loading||this.state.error?i.createElement(g.loading,{isLoading:this.state.loading,pastDelay:this.state.pastDelay,timedOut:this.state.timedOut,error:this.state.error,retry:this.retry}):this.state.loaded?g.render(this.state.loaded,this.props):null},n}(i.Component),d.contextTypes={loadable:l.shape({report:l.func.isRequired})},p}function f(e){return g(d,e)}f.Map=function(e){if("function"!=typeof e.render)throw new Error("LoadableMap requires a `render(loaded, props)` function");return g(p,e)};var h=function(e){function t(){return o(this,t),a(this,e.apply(this,arguments))}return s(t,e),t.prototype.getChildContext=function(){return{loadable:{report:this.props.report}}},t.prototype.render=function(){return i.Children.only(this.props.children)},t}(i.Component);function y(e){for(var t=[];e.length;){var n=e.pop();t.push(n())}return Promise.all(t).then((function(){if(e.length)return y(e)}))}h.propTypes={report:l.func.isRequired},h.childContextTypes={loadable:l.shape({report:l.func.isRequired}).isRequired},f.Capture=h,f.preloadAll=function(){return new Promise((function(e,t){y(c).then(e,t)}))},f.preloadReady=function(){return new Promise((function(e,t){y(u).then(e,e)}))},e.exports=f},656:function(e,t,n){"use strict";var r=n(10),o=n(2),a=n.n(o),s=n(14),i=n(119),l=n(4),c=n(3),u=n(138),d=n(12),p=n(174),m=n(11);var g=({configID:e,label:t="Code Snippet",testID:n,token:r})=>{const o=Object(l.d)();return a.a.createElement("div",{className:"code-snippet","data-testid":n},a.a.createElement(c.DapperScrollbars,{autoHide:!1,autoSizeHeight:!0,className:"code-snippet--scroll"},a.a.createElement("div",{className:"code-snippet--text"},a.a.createElement("pre",null,r))),a.a.createElement("div",{className:"code-snippet--footer"},a.a.createElement("div",null,a.a.createElement(u.a,{text:r,onCopy:()=>{o(Object(m.c)(Object(d.X)(`${r.slice(0,30).trimRight()}...`,"Script")))}}),a.a.createElement(c.Button,{size:c.ComponentSize.ExtraSmall,status:r.includes("<INFLUX_TOKEN>")?c.ComponentStatus.Default:c.ComponentStatus.Disabled,text:"Generate New API Token",titleText:"Generate New API Token",icon:c.IconFont.Refresh,color:c.ComponentColor.Success,onClick:()=>{o(Object(p.g)(e))},className:"new-token--btn"})),a.a.createElement("label",{className:"code-snippet--label"},t)))},f=n(8);let h=class extends o.PureComponent{componentDidMount(){Object(f.a)("telegrafs_page.telegraf_instructions.page_viewed")}render(){const{token:e,configID:t}=this.props,n=`telegraf --config ${this.origin}/api/v2/telegrafs/${t||""}`,r=`export INFLUX_TOKEN=${e||"<INFLUX_TOKEN>"}`;return a.a.createElement("div",{"data-testid":"setup-instructions",className:"telegraf-instructions",style:{textAlign:"left"}},a.a.createElement("h5",null,"1. Install the Latest Telegraf"),a.a.createElement("p",null,"You can install the latest Telegraf by visiting the"," ",a.a.createElement("a",{href:"https://portal.influxdata.com/downloads/",target:"_blank",rel:"noreferrer"},"InfluxData Downloads "),"page. If you already have Telegraf installed on your system, make sure it's up to date. You will need version 1.9.2 or higher."),a.a.createElement("h5",null,"2. Configure your API Token"),a.a.createElement("p",null,"Your API token is required for pushing data into InfluxDB. You can copy the following command to your terminal window to set an environment variable with your API token."),a.a.createElement(g,{token:r,configID:t,label:"CLI"}),a.a.createElement("h5",null,"3. Start Telegraf"),a.a.createElement("p",null,"Finally, you can run the following command to start the Telegraf agent running on your machine."),a.a.createElement(i.c,{text:n,label:"CLI"}))}get origin(){return window.location.origin}};h=Object(r.a)([s.a],h);t.a=h},741:function(e,t,n){"use strict";var r=n(10),o=n(2),a=n.n(o),s=n(515),i=n.n(s),l=n(4),c=n(155),u=n(14),d=n(3),p=n(11),m=n(304),g=n(174),f=n(5),h=n(13),y=n(9),b=n(105);const E=a.a.createElement("div",null),D=i()({loader:()=>Promise.all([n.e(14),n.e(63)]).then(n.bind(null,1025)),loading:()=>E});let S=class extends o.PureComponent{constructor(){super(...arguments),this.handleDismiss=()=>{const{history:e,org:t}=this.props,{onClearDataLoaders:n,onClearSteps:r}=this.props;n(),r(),e.push(`/orgs/${t.id}/load-data/telegrafs`)}}componentDidMount(){const{bucket:e,buckets:t}=this.props;if(!e&&t&&t.length){const{orgID:e,name:n,id:r}=t[0];this.props.onSetBucketInfo(e,n,r)}this.props.onSetCurrentStepIndex(0)}render(){return a.a.createElement(d.Overlay,{visible:!0},a.a.createElement(d.Overlay.Container,{maxWidth:1200},a.a.createElement(d.Overlay.Header,{title:"Create a Telegraf Configuration",onDismiss:this.handleDismiss}),a.a.createElement(d.Overlay.Body,{className:"data-loading--overlay"},a.a.createElement(D,{stepProps:this.stepProps}))))}get stepProps(){const{notify:e,currentStepIndex:t,onDecrementCurrentStepIndex:n,onIncrementCurrentStepIndex:r}=this.props;return{currentStepIndex:t,onIncrementCurrentStepIndex:r,onDecrementCurrentStepIndex:n,notify:e,onExit:this.handleDismiss}}};S=Object(r.a)([u.a],S);const T={notify:p.c,onSetBucketInfo:m.d,onIncrementCurrentStepIndex:m.c,onDecrementCurrentStepIndex:m.b,onSetCurrentStepIndex:m.e,onClearDataLoaders:g.e,onClearSteps:m.a},C=Object(l.c)(e=>{const{dataLoading:{dataLoaders:{telegrafPlugins:t},steps:{currentStep:n,substep:r,bucket:o}},me:{name:a},telegrafEditor:s}=e,i=Object(h.a)(e,f.ResourceType.Buckets).filter(e=>!Object(b.e)(e.name)),l=Object(y.a)(e);return{telegrafPlugins:t,text:s.text,currentStepIndex:n,substep:r,username:a,bucket:o,buckets:i,org:l}},T);t.a=C(Object(c.j)(S))},95:function(e,t,n){"use strict";var r=n(299).CopyToClipboard;r.CopyToClipboard=r,e.exports=r},964:function(e,t,n){"use strict";var r=n(2),o=n.n(r),a=n(3);t.a=({visible:e,resourceName:t})=>e&&o.a.createElement(a.Alert,{color:a.ComponentColor.Primary,icon:a.IconFont.AlertTriangle,className:"no-buckets-warning"},"You don't currently have any buckets. Any"," ",o.a.createElement("strong",null,t)," you have will not be able to write data until a bucket is created and they are directed to that bucket.")},965:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2),o=n.n(r),a=n(4),s=n(3),i=n(174),l=n(158),c=n(5),u=n(329),d=n(13),p=n(30),m=n(6);const g={onSaveTelegrafConfig:i.f,onUpdateTelegraf:l.f},f=Object(a.c)(e=>{var t,n;const{telegrafConfigID:r}=Object(u.a)(e),o=null!==(n=null===(t=Object(p.b)(e))||void 0===t?void 0:t.accountType)&&void 0!==n?n:"free";let a=null;if(r){a=Object(d.a)(e,c.ResourceType.Telegrafs).find(e=>e.id===r)}return{accountType:o,telegrafConfig:a}},g)(e=>{const{accountType:t,currentStepIndex:n,isValidConfiguration:a,onDecrementCurrentStepIndex:i,onExit:l,onIncrementCurrentStepIndex:c,onSaveTelegrafConfig:u,onUpdateTelegraf:d,pluginConfig:p,pluginConfigName:g,setIsValidConfiguration:f,substepIndex:h,telegrafConfig:y}=e,b=Object(r.useMemo)(()=>Boolean(y),[y]);Object(r.useEffect)(()=>{if(y){let{config:e}=y;m.f&&"free"===t&&(e=e.replace('[agent]\n  ## Default data collection interval for all inputs\n  interval = "10s"','[agent]\n  ## Default data collection interval for all inputs\n  interval = "20s"'));const n="string"==typeof e?e.indexOf(`[[inputs.${g}]]`):-1,r=n>=0?`${e.substring(0,n)}${p}`:`${e}${p}`;d(Object.assign(Object.assign({},y),{config:r}))}},[b]);const E=()=>{f(!1),c()};return 1===h||2===n?null:0===n?o.a.createElement(s.Overlay.Footer,null,o.a.createElement(s.Button,{color:s.ComponentColor.Default,onClick:l,tabIndex:1,testID:"plugin-create-configuration-cancel",text:"Cancel"}),o.a.createElement(s.Button,{color:s.ComponentColor.Primary,onClick:E,status:a?s.ComponentStatus.Valid:s.ComponentStatus.Disabled,tabIndex:0,testID:"plugin-create-configuration-continue-configuring",text:"Continue Configuring"})):o.a.createElement(s.Overlay.Footer,null,o.a.createElement(s.Button,{color:s.ComponentColor.Default,onClick:i,tabIndex:1,testID:"plugin-create-configuration-previous",text:"Previous"}),o.a.createElement(s.Button,{color:s.ComponentColor.Primary,onClick:()=>{u(),c()},status:a?s.ComponentStatus.Valid:s.ComponentStatus.Disabled,tabIndex:0,testID:"plugin-create-configuration-save-and-test",text:"Save and Test"}))})}}]);
//# sourceMappingURL=47.9216886c7f.js.map